{% extends "layouts/_layout" %}

{% block content %}

	<div class="blog-container">
	
		<div class="page-title">
			<p>ELECTRIC HERON | BLOG</p>
		</div>

		{% paginate craft.entries.section('blog').limit(3) as pageInfo, pageEntries %}

		{# Fetch all of the categories related to this entry #}
		{% set categories = craft.categories.relatedTo('') %}
		{% for entry in craft.entries.relatedTo(category).all() %}

			<div class="posts">

				<p class="posts-title">
					<a href="{{ entry.url }}">{{ entry.title }}</a>
				</p>

				{# Pull in the blog matrix field, and limit the main body content output to only the first paragraph #}
				{% for block in entry.blogMatrix %}

					{% switch block.type %}
												
						{% case 'blogBody' %}

							{% set paragraphs = block.blogBody|split('</p>') %}
							{% set teaser = paragraphs|first ~ '</p>' %}
							
							<div class="excerpt">
								<p>{{ teaser|raw }}</p>
							</div>
			  				
					{% endswitch %}

				{% endfor %}

				{# Meta info and categories for the post #}
				<div>
					<p class="post-meta">Posted by {{ entry.author }}
					on {{ entry.postDate | date('d.M.Y') }}</p>
				</div>

				<div class="categories">
					<p>File Under:
						{% set categories = craft.categories %}
						{% for category in entry.categories %}
						
						<a href="{{ category.url }}" class="cat-link">{{ category.title }}</a>
					
						{% endfor %}
					</p>
				</div>
			
			</div>	
	
		{% endfor %}


{# Pagination and home page link #}
		<div class="blog-nav">

			{# {% if pageInfo.prevUrl %}
				<a href="{{ pageInfo.prevUrl }}" class="blog-nav-link">Prev</a>
			{% endif %}
			
			{% if pageInfo.nextUrl %}
				<a href="{{ pageInfo.nextUrl }}" class="blog-nav-link">Next</a>
			{% endif %} #}

			<a href="/blog/index.html" class="blog-nav-link">Blog Home</a>
		</div>




	</div>
	
{% endblock %}


